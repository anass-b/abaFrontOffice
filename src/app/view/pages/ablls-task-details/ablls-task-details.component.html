<!-- üåí Barre de navigation -->
<nav class="navbar navbar-expand-lg" style="background-color: #4b2c5e;">
  <div class="container-fluid px-4 py-2 d-flex justify-content-between align-items-center">
    <span class="navbar-brand mb-0 h5 text-white">
      {{ task?.code }}
    </span>
    <a
      class="btn btn-outline-light rounded-pill"
      [routerLink]="['/taches']"
      [queryParams]="{
        category: selectedCategory,
        domain: selectedDomain
      }"
    >
      ‚Üê Retour aux t√¢ches
    </a>
  </div>
</nav>

<!-- üîΩ Contenu principal -->
<div class="container py-4 text-center" *ngIf="task; else loading">
  <h2 class="mb-4">T√¢che {{ task.code }} : {{ task.title }}</h2>

  <!-- Crit√®res -->
  <div *ngIf="task.evaluationCriterias?.length" class="d-flex justify-content-center flex-wrap gap-2 mb-3">
    <a
      *ngFor="let crit of task.evaluationCriterias; let i = index"
      [routerLink]="['/evaluation-criteria', crit.id]"
      class="btn btn-primary"
    >
      Crit√®re {{ i + 1 }}
    </a>
  </div>

  <!-- üé• Vid√©o -->
  <div class="d-flex justify-content-center mb-4">
    <!-- Si Lien externe -->
    <iframe
      *ngIf="task.explanationVideoUrl"
      width="560"
      height="315"
      [src]="getSafeUrl(task.explanationVideoUrl!)"
      frameborder="0"
      allowfullscreen
    ></iframe>

    <!-- Si Fichier local -->
    <video
      *ngIf="!task.explanationUseExternal && task.explanationVideoPath"
      width="560"
      height="315"
      controls
    >
      <source [src]="baseUrl + task.explanationVideoPath!" type="video/mp4" />
      Votre navigateur ne supporte pas la lecture de la vid√©o.
    </video>
  </div>

</div>

<!-- Chargement -->
<ng-template #loading>
  <div class="text-center mt-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-3">Chargement de la t√¢che...</p>
  </div>
</ng-template>
