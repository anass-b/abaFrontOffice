<div class="modal-content p-3 p-md-4">
  <h5 class="mb-3">Ajouter un critère d’évaluation</h5>

  <form [formGroup]="form" (ngSubmit)="save()" class="row g-3">

    <div class="col-12">
      <label>Libellé *</label>
      <input type="text" formControlName="label" class="form-control" required />
    </div>

    <div class="col-12">
      <label>Consigne</label>
      <textarea formControlName="consigne" class="form-control"></textarea>
    </div>

    <div class="col-md-6">
      <label>Type de guidance</label>
      <select class="form-select" formControlName="guidanceType">
        <option value="Aucune">Aucune</option>
        <option value="Physique">Physique</option>
        <option value="Verbale">Verbale</option>
        <option value="Gestuelle">Gestuelle</option>
      </select>
    </div>

    <div class="col-md-6">
      <label>Réponse attendue</label>
      <input type="text" formControlName="expectedResponse" class="form-control" />
    </div>

    <div class="col-md-12">
      <label>Type de démonstration</label>
      <select class="form-select" (change)="onVideoTypeChange($event)">

        <option value="url" selected>URL externe (YouTube, etc.)</option>
        <option value="file">Fichier local</option>
      </select>
    </div>

    <div *ngIf="useExternal" class="col-12">
      <label>URL de démonstration</label>
      <input type="url" formControlName="demonstrationVideoUrl" class="form-control" />
    </div>

    <div *ngIf="!useExternal" class="col-12">
      <label>Vidéo démonstration</label>
      <input type="file" class="form-control" (change)="onVideoFileSelected($event)" />
    </div>

    <div class="col-12">
      <label>Miniature (optionnelle)</label>
      <input type="file" class="form-control" (change)="onThumbnailSelected($event)" />
    </div>

    <div class="col-12">
  <label for="materialSelect">Matériels associés</label>
  
  <!-- Select Dropdown -->
  <select id="materialSelect" class="form-select mt-2"
          (change)="onMaterialSelected($event)">
    <option [value]="''" disabled selected>-- Choisir un matériel --</option>
    <option *ngFor="let mat of materialPhotos" [value]="mat.id" [disabled]="selectedMaterialIds.includes(mat.id!)">
      {{ mat.name }}
    </option>
  </select>

  <!-- Selected Materials as Tags -->
  <div class="mt-3 d-flex flex-wrap gap-2">
    <span *ngFor="let id of selectedMaterialIds" class="badge bg-primary d-flex align-items-center">
      {{ getMaterialName(id) }}
      <button type="button" class="btn-close btn-close-white ms-2" aria-label="Remove" (click)="removeMaterial(id)"></button>
    </span>
  </div>
</div>


    <div class="col-12 text-end mt-4">
      <button type="submit" class="btn btn-primary" [disabled]="form.invalid">Enregistrer</button>
      <button type="button" class="btn btn-secondary ms-2" (click)="close()">Annuler</button>
    </div>
  </form>
</div>
